"use strict";function Hermite_class(){var v,p,_=[];this.init=void(v=navigator.hardwareConcurrency||4),this.getCores=function(){return v},this.resample_auto=function(t,a,e,r,h){var i=this.getCores();window.Worker&&1<i?this.resample(t,a,e,r,h):(this.resample_single(t,a,e,!0),null!=h&&h())},this.resize_image=function(t,a,e,r,h){var i=document.getElementById(t),n=document.createElement("canvas");n.width=i.width,n.height=i.height;function o(){var t=n.toDataURL();i.width=a,i.height=e,i.src=t,n=null}n.getContext("2d").drawImage(i,0,0),null==a&&null==e&&null!=r&&(a=i.width/100*r,e=i.height/100*r),null==e&&(t=i.width/a,e=i.height/t),a=Math.round(a),e=Math.round(e);null==h||1==h?this.resample(n,a,e,!0,o):(this.resample_single(n,a,e,!0),o())},this.resample=function(t,r,a,e,h){var i=t.width,n=t.height,o=(r=Math.round(r),n/(a=Math.round(a)));if(0<_.length)for(var s=0;s<v;s++)null!=_[s]&&(_[s].terminate(),delete _[s]);_=new Array(v);for(var l=t.getContext("2d"),c=[],g=2*Math.ceil(n/v/2),d=-1,s=0;s<v;s++){var u,M=d+1;n<=M||(d=M+g-1,d=Math.min(d,n-1),u=g,u=Math.min(g,n-M),c[s]={},c[s].source=l.getImageData(0,M,i,g),c[s].target=!0,c[s].start_y=Math.ceil(M/o),c[s].height=u)}!0===e?(t.width=r,t.height=a):l.clearRect(0,0,i,n);for(var m,f,w=0,s=0;s<v;s++)null!=c[s]&&(w++,m=new Worker(p),(_[s]=m).onmessage=function(t){w--;var a=t.data.core,e=(_[a].terminate(),delete _[a],Math.ceil(c[a].height/o));c[a].target=l.createImageData(r,e),c[a].target.data.set(t.data.target),l.putImageData(c[a].target,0,c[a].start_y),w<=0&&null!=h&&h()},f={width_source:i,height_source:c[s].height,width:r,height:Math.ceil(c[s].height/o),core:s,source:c[s].source.data.buffer},m.postMessage(f,[f.source]))},p=window.URL.createObjectURL(new Blob(["(",function(){onmessage=function(t){for(var a=t.data.core,e=t.data.width_source,r=t.data.height_source,h=t.data.width,i=t.data.height,n=e/h,o=r/i,s=Math.ceil(n/2),l=Math.ceil(o/2),c=new Uint8ClampedArray(t.data.source),t=h*i*4,g=new ArrayBuffer(t),d=new Uint8ClampedArray(g,0,t),u=0;u<i;u++)for(var M=0;M<h;M++){for(var m=4*(M+u*h),f=0,w=0,v=0,p=0,_=0,y=0,b=0,C=u*o,I=Math.floor(M*n),D=Math.ceil((M+1)*n),R=Math.floor(u*o),U=Math.ceil((u+1)*o),D=Math.min(D,e),U=Math.min(U,r),x=R;x<U;x++)for(var A=Math.abs(C-x)/l,B=M*n,L=A*A,j=I;j<D;j++){var k=Math.abs(B-j)/s,k=Math.sqrt(L+k*k);1<=k||(b+=(f=2*k*k*k-3*k*k+1)*c[3+(k=4*(j+x*e))],v+=f,p+=(f=c[3+k]<255?f*c[3+k]/250:f)*c[k],_+=f*c[1+k],y+=f*c[2+k],w+=f)}d[m]=p/w,d[1+m]=_/w,d[2+m]=y/w,d[3+m]=b/v}postMessage({core:a,target:d},[d.buffer])}}.toString(),")()"],{type:"application/javascript"})),this.resample_single=function(t,a,e,r){for(var h=t.width,i=t.height,n=h/(a=Math.round(a)),o=i/(e=Math.round(e)),s=Math.ceil(n/2),l=Math.ceil(o/2),c=t.getContext("2d"),g=c.getImageData(0,0,h,i),d=c.createImageData(a,e),u=g.data,M=d.data,m=0;m<e;m++)for(var f=0;f<a;f++){for(var w=4*(f+m*a),v=0,p=0,_=0,y=0,b=0,C=0,I=0,D=m*o,R=Math.floor(f*n),U=Math.ceil((f+1)*n),x=Math.floor(m*o),A=Math.ceil((m+1)*o),U=Math.min(U,h),A=Math.min(A,i),B=x;B<A;B++)for(var L=Math.abs(D-B)/l,j=f*n,k=L*L,q=R;q<U;q++){var E=Math.abs(j-q)/s,E=Math.sqrt(k+E*E);1<=E||(I+=(v=2*E*E*E-3*E*E+1)*u[3+(E=4*(q+B*h))],_+=v,y+=(v=u[3+E]<255?v*u[3+E]/250:v)*u[E],b+=v*u[1+E],C+=v*u[2+E],p+=v)}M[w]=y/p,M[1+w]=b/p,M[2+w]=C/p,M[3+w]=I/_}!0===r?(t.width=a,t.height=e):c.clearRect(0,0,h,i),c.putImageData(d,0,0)}}module.exports=Hermite_class;
